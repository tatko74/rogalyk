


MODULE
INCLUDE "H6:VARS.ACT"

CARD TIMECOUNT2=538,rptime,meloadr
int licznik=0

BYTE ARRAY melodia=[125 125 125 125 125 125 125 125 125 125 125 125 125 125 125 125 125 0 
106 101 122 121 107 0 112 114 111 103 114 97 109 111 119 97 110 105 97
 0 97 99 116 105 111 110 126 0 106 101 115 116 0 115 101 114 99 101 109 
 0 99 97 108 101 103 111 0 115 121 115 116 101 109 117 96 0 108 97 99 
 122 121 0 111 110 0 119 115 122 121 115 116 107 105 101 0 100 111 98 
 114 101 0 99 101 99 104 121 0 106 101 122 121 107 111 119 0 99 0 105 0 
 112 97 115 99 97 108 0 111 114 97 122 0 100 111 100 97 116 107 111 119 
 111 0 106 101 115 116 0 110 97 106 115 122 121 98 115 122 121 109 0 106
 101 122 121 107 105 101 109 0 119 121 115 111 107 105 101 103 111 0 112
 111 122 105 111 109 117 0 100 111 115 116 101 112 110 121 109 0 110 97 
 0 107 111 109 112 117 116 101 114 121 0 97 116 97 114 105 96 0 119 0 112
 111 114 111 119 110 97 110 105 117 0 122 0 98 97 115 105 99 105 101 109 
 0 97 99 116 105 111 110 126 0 106 101 115 116 0 106 101 122 121 107 105 
 101 109 0 115 116 114 117 107 116 117 114 97 108 110 121 109 96 0 97 0 
 106 101 115 116 0 114 111 119 110 105 101 0 108 97 116 119 121 109 0 100
 111 0 110 97 117 99 122 101 110 105 97 127 0 112 114 111 103 114 97 109
 121 0 110 97 112 105 115 97 110 101 0 119 0 106 101 122 121 107 117 0 97 
 99 116 105 111 110 126 0 99 104 97 114 97 107 116 101 114 121 122 117 106 
 97 0 115 105 101 0 100 117 122 97 0 112 114 122 101 106 114 122 121 115 
 116 111 115 99 105 97 0 124 0 0 123 0 96 125 125 125 125 125 125 125 125 
 125 125 125 125 125 125 125 125 125 ]

INCLUDE "H6:LITFUN.ACT"
INCLUDE "H6:FNTGR.ACT"


CARD FUNC StartVKT(BYTE ARRAY name)
  BYTE find,j,size
  CARD ic,addr
  find=0 size=name(0)
  FOR ic=20000 TO 40000 DO
    j=1
    WHILE Peek(ic+j)=name(j) DO
      IF j=size THEN find=1 FI
      j==+1
    OD
    IF find=1 THEN EXIT FI
  OD
  IF find=0 then poke(scrmem+5,1) fi 
  addr=PeekC(ic+j+1)
RETURN(addr)

PROC GRAJ()
  [$A2 $07 $B5 $C0 $48 $B5 $A8 $48 $B5 $A0 $48 $B5 $80 $48 $CA $10 $F1 $A5 $D3 $48]
  poke(scrmem+2+40,3)
  MOVEBLOCK(scrmem+220,meloadr+licznik,20)
  licznik==+1
  IF licznik=387 THEN licznik=0 FI
  TIMECOUNT2=rptime
  [$68 $85 $D3 $A2 $00 $68 $95 $80 $68 $95 $A0 $68 $95 $A8 $68 $95 $C0 $E8 $E0 $08 $D0 $EF]
  [$60]
RETURN


PROC SetTIMER2()
CARD TIMER2VKT=552
card ggggg
  rptime=5
  ggggg=$1945;32590;StartVKT("GRAJ")
  TIMER2VKT=ggggg
  TIMECOUNT2=10
  poke(scrmem+1,3)
RETURN


PROC Main()
    InitChar()
    InitCol()

meloadr=peekc(@melodia)
  licznik=0
  SetTIMER2()
  DO
  if peek(scrmem+0)=1 then poke(scrmem+0,2) else poke(scrmem+0,1) fi
  OD

RETURN
